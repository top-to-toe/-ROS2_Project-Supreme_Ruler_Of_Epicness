
# ROS 2 Navigation2 프로젝트 진행 내용 (2024-08-20)

## 오전 작업 요약

### 1. 문제 정의
- **목표**: 로봇이 설정된 경유지(waypoints)를 순차적으로 이동한 후 원점으로 돌아오는 작업을 수행.
- **발생한 문제**: 로봇이 경유지로 이동하지 않고 예상치 못한 경로를 택하거나 원점으로 바로 돌아옴.

### 2. 코드 수정 시도
- 기존 코드에서 경유지로 로봇을 이동시키기 위한 액션 클라이언트를 설정하고 목표 위치로 이동하는 로직을 수정.
- 피드백 콜백, 목표 수락 및 결과 콜백 등을 추가하여 로봇이 경유지로 이동하는 과정을 모니터링.
- **결과**: 여전히 로봇이 올바른 경유지로 이동하지 않고, 경로를 벗어나는 문제가 발생.

## 오후 작업 요약

### 3. 코드 디버깅 및 수정
- **오후 1:00 - 2:00**: 코드 분석 및 경유지 설정 로직 개선.
    - `send_goal_options.result_callback`에 대한 수정 시도.
    - 각 경유지로 이동할 때마다 목표가 올바르게 설정되는지 확인.
- **오후 2:00 - 3:00**: 문제 지속 발생.
    - 로봇이 첫 번째 경유지에 잠깐 이동했다가 원점으로 돌아가는 현상 확인.
    - 이동 경로가 예상과 다르게 설정되는 문제 지속.
- **오후 3:00 - 4:00**: 추가적인 코드 로직 점검.
    - 콜백 함수의 처리 로직을 수정하고, 결과에 따라 다음 경유지로 이동하도록 수정.
- **오후 4:00 - 5:00**: 문제 해결을 위한 추가적인 코드 테스트.
    - 테스트 결과 여전히 경유지로 이동하지 않고, 원점으로 바로 이동하는 문제 발생.

### 4. 다음 단계 계획
- Navigation2 설정 및 경유지 설정 로직의 근본적인 문제를 재검토.
- 추가적인 디버깅 도구 사용을 고려하고, 로봇의 센서 및 위치 데이터 확인 필요.

# ROS 2 일경험 프로젝트 관련 진행 내용 (~2024-08-23)
# 자율 이동 로봇 시스템 프로젝트

## 프로젝트 개요
이 프로젝트는 자율 이동 로봇이 주어진 경로를 따라 이동하며, 도착지에 도달했을 때 특정 작업(LED 점등)을 수행하는 시스템을 구축하는 것을 목표로 합니다. ROS 2를 기반으로 다양한 노드를 개발하였으며, 라즈베리 파이의 GPIO 핀을 활용하여 LED 제어 기능을 포함시켰습니다.

## 시스템 아키텍처
이 시스템은 여러 개의 ROS 2 노드로 구성되어 있으며, 각 노드는 Pub/Sub 메커니즘과 서비스 호출을 통해 서로 데이터를 교환합니다. 주요 아키텍처 구성은 다음과 같습니다:
- **경로 추종 노드** (`waypoints_follower_client.cpp`)
- **위치 퍼블리싱 노드** (`current_position_publisher.cpp`)
- **목표 위치 구독 노드** (`target_position_subscriber.cpp`)
- **경로 설정 서비스 노드** (`waypoints_service_server.cpp`)
- **LED 제어 서비스 서버 및 클라이언트** (`led_service_server.py`, `led_service_client.py`)

## 주요 기능
### 경로 추종 노드 (`waypoints_follower_client.cpp`)
이 노드는 미리 정의된 경로를 따라 로봇을 이동시키는 액션 클라이언트입니다. 경로 설정, 전송, 피드백 수신을 통해 로봇이 정확한 경로를 추종하도록 합니다. 또한, 로봇이 경로의 시작과 끝에서 LED를 자동으로 제어합니다.

### 위치 퍼블리싱 노드 (`current_position_publisher.cpp`)
로봇의 현재 위치를 주기적으로 퍼블리시하여 다른 노드들이 이를 구독할 수 있도록 합니다. 위치 정보는 `geometry_msgs::msg::PoseStamped` 형식으로 제공되며, 쿼터니언을 사용해 로봇의 회전 정보를 처리합니다.

### 목표 위치 구독 노드 (`target_position_subscriber.cpp`)
이 노드는 'target_position' 토픽을 구독하여 로봇이 목표 위치를 수신하고, 수신된 데이터를 기반으로 회전 각도를 계산하여 로봇의 상태를 모니터링합니다.

### 경로 설정 서비스 노드 (`waypoints_service_server.cpp`)
클라이언트가 설정한 경로 점을 수신하고 이를 내부적으로 저장하여 로봇이 경로를 따라 이동할 수 있도록 합니다. 입력된 경로 점의 유효성을 검사하여 데이터의 일관성을 유지합니다.

### LED 제어 서비스
- **서버 노드** (`led_service_server.py`): 라즈베리 파이의 GPIO 핀을 사용해 LED를 제어합니다. 클라이언트의 요청에 따라 LED를 켜거나 끕니다.
- **클라이언트 노드** (`led_service_client.py`): 비동기 방식으로 LED 제어 요청을 서버로 전송하며, 결과를 처리합니다.

## 설치 및 실행 방법
### 1. ROS 2 워크스페이스 구성
ROS 2가 설치된 환경에서 다음 명령어를 통해 워크스페이스를 설정합니다.
```bash
mkdir -p ~/ros2_ws/src
cd ~/ros2_ws/src
git clone <repository-url>
cd ..
colcon build